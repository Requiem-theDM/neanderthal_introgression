# Reviving the Past: A Replication of Neanderthal DNA's Role in Human Gene Expression
## Josh Beale, Caroline Moore, Fijare Plous

## Project Description
Our project aims to replicate Figure 4 from McCoy et al., 2017, titled “Impacts of Neanderthal-introgressed sequences on the landscape of human gene expression.” This figure visualizes purifying selection on the gradual movement of genes from one species into the gene pool of another, via the hybridization of humans and Neanderthals. The analysis within the figure looks at allele frequency classification between Neanderthal genes that have moved into the human population and those that have not. Ultimately McCoy et. al. found no significant differences in allele-specific expression between introgressed and non-introgressed variants. Our project seeks to not only replicate these findings but to expand on them by analyzing the introgression of alleles from Denisovans—another extinct human subspecies that interbred with Homo sapiens. 


## Figure Example
- https://www.ncbi.nlm.nih.gov/pmc/articles/instance/6219754/bin/nihms-848864-f0004.jpg 

## Datasets
- https://github.com/mccoy-lab/MAGE/tree/main
- https://data.mendeley.com/datasets/y7hyt83vxr/1

## Software Requirements
- Python version 3.12.3 or higher
- Pandas version 2.2.2 or higher
- R version 4.4.1 or higher
- GNU bash, version 3.2.57(1)-release or higher

## Proposed Workflow
1. Align credible sets from finemapping MAGE eQTL based on varying PIP thresholds with SNPs from Sprime dataset based on if the Sprime matches either neanderthals or denisovans.
2. Generate figures for neanderthal matches
- Derived Allele Frequency vs. Number of SNPs
- Significant differences in the estimated proportions of introgressed (pN) and non-introgressed (pH) variants showing significant ASE (at 10% FDR), stratified by derived allele frequency
3. Generate figures for Denisovan matches
- Derived Allele Frequency vs. Number of SNPs
- Significant differences in the estimated proportions of introgressed (pN) and non-introgressed (pH) variants showing significant ASE (at 10% FDR), stratified by derived allele frequency

## End of Term Presentation
[The slide deck for our presentation is available here.](https://docs.google.com/presentation/d/1InTnAfotq8y3MgHqU8PTZ328DmD4UdptEyXa_lIMsGQ/edit?usp=sharing)
```
Repository Structure
.
├── README.md
├── analysis                    <- All data analysis scripts
│   └── log.txt                 <- Alignment runtime log for alignSNPs.py
├── comm                        <- internal communication such as meeting notes
├── data
│   ├── data_clean      
│   │    ├── Alignments         <- Output folder for alignments generated by alignSNPs.py
│   │    ├── eQTL_finemapping   <- Clean version of the data generated by processArchives.sh
│   │    └── Sprime_results     <- Clean version of the data generated by processArchives.sh and processSprimes.sh
│   └── data_raw                <- Raw data storage
├── diss
│   └── presentations           <- end of semester presentation
├── doc                         <- documentation
│    └── HowToUse.md            <- Instructions for replicating the findings of this project
└── misc                        <- miscellaneous files that don't fit elsewhere  
```
